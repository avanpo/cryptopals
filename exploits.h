#ifndef HEADER_EXPLOITS_H
#define HEADER_EXPLOITS_H

#include "oracles.h"

char break_ciphertext_single_byte_xor(const unsigned char *ciphertext, size_t length, unsigned char *plaintext);

int detect_repeating_block(unsigned char *ciphertext, size_t length, int block_length);

int detect_oracle_block_length(oracle_t oracle);
int detect_oracle_mode(oracle_t oracle, int block_length);

int detect_ECB_oracle_prefix_length(oracle_t oracle, int block_length);

int break_ciphertext_CBC_padding_oracle(const unsigned char *ciphertext, unsigned char *plaintext, size_t length, oracle_t oracle, const unsigned char *iv);

#endif
